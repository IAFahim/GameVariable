# ğŸ§  GameVariable.Intent

**The Traffic Light for Game Logic.** ğŸš¦

**GameVariable.Intent** is a high-performance, zero-allocation **Hierarchical State Machine (HSM)**. It manages complex behaviors (like AI, Quests, or Cutscenes) so your code doesn't turn into a plate of spaghetti.

---

## ğŸ§  Mental Model: The Traffic Light ğŸš¦

Think of a **Traffic Light**.
*   **Green (RUNNING):** "Go! Do the thing!"
*   **Red (FAULTED):** "Stop! Something broke!"
*   **Yellow (PENDING):** "Get ready..."
*   **Off (INACTIVE):** "Not working right now."

**GameVariable.Intent** manages these states for *Tasks*.
Instead of `bool isRunning`, `bool isDone`, `bool isFailed` scattered everywhere, you have **One State** to rule them all.

---

## ğŸ“¦ Installation

```bash
dotnet add package GameVariable.Intent
```

---

## ğŸš€ Features

*   **âš¡ Zero Allocation:** Pure `struct` based. No GC pressure.
*   **ğŸ—ï¸ Hierarchical:** Supports Parent-Child relationships (Tasks inside Tasks).
*   **ğŸ§µ Thread-Unsafe:** Designed for the Main Thread (Unity Loop) for maximum speed.
*   **ğŸ¤– Autogenerated:** Powered by [StateSmith](https://github.com/StateSmith/StateSmith) for bulletproof logic.

---

## ğŸš¦ The States

| State | Color | Meaning |
|-------|-------|---------|
| `CREATED` | âšª | Just born. Knows nothing. |
| `INACTIVE` | ğŸŒ‘ | Prepared, but turned off. |
| `PENDING` | ğŸŸ¡ | Queueing... ready to start. |
| `RUNNING` | ğŸŸ¢ | **ACTION!** The task is happening. |
| `BLOCKED` | ğŸŸ  | "Hold on, I'm waiting for my kid (Child Task)." |
| `COMPLETED`| ğŸ | Finished successfully. |
| `FAULTED` | ğŸ”´ | Error! Something exploded. |
| `CANCELLED`| âš« | "Nevermind, forget it." |

---

## ğŸ® Usage Guide

### 1. The Happy Path (Success)

```csharp
using GameVariable.Intent;

var task = new IntentState();
task.Start(); // Enters CREATED

// 1. Activate it
task.DispatchEvent(IntentState.EventId.ACTIVATE); // -> PENDING

// 2. Start doing work
task.DispatchEvent(IntentState.EventId.START); // -> RUNNING

// ... Doing work ...

// 3. We finished!
task.DispatchEvent(IntentState.EventId.COMPLETE); // -> COMPLETED
```

### 2. The Sad Path (Failure & Recovery)

```csharp
// ... Oops, enemy died while we were targeting it
task.DispatchEvent(IntentState.EventId.FAIL); // -> FAULTED

// Check if it failed
if (task.stateId == IntentState.StateId.FAULTED)
{
    Console.WriteLine("Task failed!");

    // Retry?
    task.DispatchEvent(IntentState.EventId.RECOVER); // -> PENDING
}
```

### 3. Parenting (Blocking)

"I can't finish this Quest until I kill 10 rats."

```csharp
// Parent is RUNNING
parentTask.DispatchEvent(IntentState.EventId.SPAWN_CHILD);
// Parent -> BLOCKED (Waiting for child)

// ... Child task runs ...

// Child finishes
parentTask.DispatchEvent(IntentState.EventId.RESUME);
// Parent -> RUNNING (Back in action)
```

---

## ğŸ—ï¸ Architecture

This library follows the **Data-Logic-Extension Triad**:

1.  **Layer A (Data):** `IntentState` struct. Just memory.
2.  **Layer B (Logic):** Event handlers. Pure math/state transitions.
3.  **Layer C (API):** `IIntent` interface. The buttons you press.

---

<div align="center">

**Part of the [GameVariable](https://github.com/iafahim/GameVariable) Ecosystem**
*Made with â¤ï¸ for game developers*

</div>
